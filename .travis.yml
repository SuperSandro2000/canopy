language: ruby
cache: bundler
rvm:
- 2.5
env:
- linux=true
before_install:
  - gem install bundler
jobs:
  include:
    - stage: test
      deploy:
        provider: rubygems
        gem: canuby
        api_key: $RUBYGEMS_API_KEY
        on:
          branch: master
          tags: true
    - stage: github pages
      deploy:
        rvm: 2.5
        provider: pages
        github-token:
          secure: $GITHUB_TOKEN
        keep-history: true
        local-dir: docs
        script: bundle exec rake rerdoc
        on:
          branch: master
notifications:
  webhooks: https://www.travisbuddy.com/
